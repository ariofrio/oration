<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />

  <title>Module: Generator</title>

  <link rel="stylesheet" href="./rdoc.css" type="text/css" media="screen" />

  <script src="./js/jquery.js" type="text/javascript"
    charset="utf-8"></script>
  <script src="./js/thickbox-compressed.js" type="text/javascript"
    charset="utf-8"></script>
  <script src="./js/quicksearch.js" type="text/javascript"
    charset="utf-8"></script>
  <script src="./js/darkfish.js" type="text/javascript"
    charset="utf-8"></script>

</head>
<body class="module">

  <div id="metadata">
    <div id="home-metadata">
      <div id="home-section" class="section">
        <h3 class="section-header">
          <a href="./index.html">Home</a>
          <a href="./index.html#classes">Classes</a>
          <a href="./index.html#methods">Methods</a>
        </h3>
      </div>
    </div>

    <div id="file-metadata">
      <div id="file-list-section" class="section">
        <h3 class="section-header">In Files</h3>
        <div class="section-body">
          <ul>
          
            <li><a href="./lib/generator_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
              class="thickbox" title="lib/generator.rb">lib/generator.rb</a></li>
          
          </ul>
        </div>
      </div>

      
    </div>

    <div id="class-metadata">

      <!-- Parent Class -->
      

      <!-- Namespace Contents -->
      

      <!-- Method Quickref -->
      
      <div id="method-list-section" class="section">
        <h3 class="section-header">Methods</h3>
        <ul class="link-list">
          
          <li><a href="#method-c-copy_app_files">::copy_app_files</a></li>
          
          <li><a href="#method-c-generate_app">::generate_app</a></li>
          
          <li><a href="#method-c-generate_go_app">::generate_go_app</a></li>
          
          <li><a href="#method-c-generate_python_app">::generate_python_app</a></li>
          
          <li><a href="#method-c-write_go_app_yaml_file">::write_go_app_yaml_file</a></li>
          
          <li><a href="#method-c-write_go_cicero_code">::write_go_cicero_code</a></li>
          
          <li><a href="#method-c-write_python_app_yaml_file">::write_python_app_yaml_file</a></li>
          
          <li><a href="#method-c-write_python_cicero_code">::write_python_cicero_code</a></li>
          
        </ul>
      </div>
      

      <!-- Included Modules -->
      
    </div>

    <div id="project-metadata">
      
      

      <div id="classindex-section" class="section project-section">
        <h3 class="section-header">Class/Module Index
          <span class="search-toggle"><img src="./images/find.png"
            height="16" width="16" alt="[+]"
            title="show/hide quicksearch" /></span></h3>
        <form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
        <fieldset>
          <legend>Quicksearch</legend>
          <input type="text" name="quicksearch" value=""
            class="quicksearch-field" />
        </fieldset>
        </form>

        <ul class="link-list">
        
          <li><a href="./Generator.html">Generator</a></li>
        
          <li><a href="./Object.html">Object</a></li>
        
          <li><a href="./OrationFlags.html">OrationFlags</a></li>
        
        </ul>
        <div id="no-class-search-results" style="display: none;">No matching classes.</div>
      </div>

      
    </div>
  </div>

  <div id="documentation">
    <h1 class="module">Generator</h1>

    <div id="description">
      
    </div>

    <!-- Constants -->
    

    <!-- Attributes -->
    

    <!-- Methods -->
    
    <div id="public-class-method-details" class="method-section section">
      <h3 class="section-header">Public Class Methods</h3>

    
      <div id="copy_app_files-method" class="method-detail ">
        <a name="method-c-copy_app_files"></a>

        
        <div class="method-heading">
          <span class="method-name">copy_app_files</span><span
            class="method-args">(main_file, output_dir, fileutils=FileUtils)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Copies over any files in the directory the user has given us over to the
new directory we are making for their App Engine app.</p>
          

          
          <div class="method-source-code"
            id="copy_app_files-source">
<pre>
<span class="ruby-comment"># File lib/generator.rb, line 164</span>
def self.copy_app_files(main_file, output_dir, fileutils=<span class="ruby-constant">FileUtils</span>)
  source_dir = <span class="ruby-constant">File</span>.dirname(main_file) + <span class="ruby-string">&quot;/.&quot;</span>
  <span class="ruby-constant">FileUtils</span>.cp_r(source_dir, output_dir)
end</pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="generate_app-method" class="method-detail ">
        <a name="method-c-generate_app"></a>

        
        <div class="method-heading">
          <span class="method-name">generate_app</span><span
            class="method-args">(main_file, function_name, output_dir, app_id, generate_python_app=Generator.method(:generate_python_app), generate_go_app=Generator.method(:generate_go_app))</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>This function finds out what language the application we need to make
‘Cicero-ready’ is, and if it is a supported language, dispatches the
necessary function to do so. See SUPPORTED_LANGUAGES for the currently
supported languages.</p>
          

          
          <div class="method-source-code"
            id="generate_app-source">
<pre>
<span class="ruby-comment"># File lib/generator.rb, line 18</span>
def self.generate_app(main_file,
    function_name,
    output_dir,
    app_id,
    generate_python_app=<span class="ruby-constant">Generator</span>.method(:generate_python_app),
    generate_go_app=<span class="ruby-constant">Generator</span>.method(:generate_go_app))

  file_suffix = main_file.scan(<span class="ruby-regexp">/\.(.*)\Z/</span>).flatten.to_s

  if file_suffix.empty?  <span class="ruby-comment"># no suffix</span>
    abort(<span class="ruby-string">&quot;The file specified needs an extension.&quot;</span>)
  end

  if !<span class="ruby-constant">SUPPORTED_LANGUAGES</span>.include?(file_suffix)
    abort(<span class="ruby-string">&quot;The file specified is not in a supported language. Supported &quot;</span> +
      &quot;languages are #{SUPPORTED_LANGUAGES.join(', ')}&quot;)
  end

  case file_suffix
  when <span class="ruby-string">&quot;py&quot;</span>
    generate_python_app.call(main_file, function_name, output_dir, app_id)
  when <span class="ruby-string">&quot;go&quot;</span>
    generate_go_app.call(main_file, function_name, output_dir, app_id)
  end
end</pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="generate_go_app-method" class="method-detail ">
        <a name="method-c-generate_go_app"></a>

        
        <div class="method-heading">
          <span class="method-name">generate_go_app</span><span
            class="method-args">(main_file, function_name, output_dir, app_id, make_directory=FileUtils.method(:mkdir_p), write_go_app_yaml=Generator.method(:write_go_app_yaml_file), write_go_cicero_code=Generator.method(:write_go_cicero_code), copy_app_files=Generator.method(:copy_app_files))</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>This method generates a Go Google App Engine application containing the
function that the user specified.</p>
          

          
          <div class="method-source-code"
            id="generate_go_app-source">
<pre>
<span class="ruby-comment"># File lib/generator.rb, line 63</span>
def self.generate_go_app(main_file, function_name, output_dir, app_id,
  make_directory=<span class="ruby-constant">FileUtils</span>.method(:mkdir_p),
  write_go_app_yaml=<span class="ruby-constant">Generator</span>.method(:write_go_app_yaml_file),
  write_go_cicero_code=<span class="ruby-constant">Generator</span>.method(:write_go_cicero_code),
  copy_app_files=<span class="ruby-constant">Generator</span>.method(:copy_app_files))

  make_directory.call(output_dir)
  go_code_folder = output_dir + <span class="ruby-constant">File</span>::<span class="ruby-constant">Separator</span> + function_name
  make_directory.call(go_code_folder)

  write_go_app_yaml.call(app_id, output_dir)
  write_go_cicero_code.call(main_file, function_name, go_code_folder)
  copy_app_files.call(main_file, go_code_folder)
end</pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="generate_python_app-method" class="method-detail ">
        <a name="method-c-generate_python_app"></a>

        
        <div class="method-heading">
          <span class="method-name">generate_python_app</span><span
            class="method-args">(main_file, function_name, output_dir, app_id, make_directory=FileUtils.method(:mkdir_p), write_python_app_yaml=Generator.method(:write_python_app_yaml_file), write_python_cicero_code=Generator.method(:write_python_cicero_code), copy_app_files=Generator.method(:copy_app_files))</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>This method generates a Python Google App Engine application containing the
function that the user specified. This requires us to search their code for
the actual function, make a directory for their app, write an app.yaml for
the app, and a Python file containing our Cicero interface and their
function.</p>
          

          
          <div class="method-source-code"
            id="generate_python_app-source">
<pre>
<span class="ruby-comment"># File lib/generator.rb, line 49</span>
def self.generate_python_app(main_file, function_name, output_dir, app_id,
  make_directory=<span class="ruby-constant">FileUtils</span>.method(:mkdir_p),
  write_python_app_yaml=<span class="ruby-constant">Generator</span>.method(:write_python_app_yaml_file),
  write_python_cicero_code=<span class="ruby-constant">Generator</span>.method(:write_python_cicero_code),
  copy_app_files=<span class="ruby-constant">Generator</span>.method(:copy_app_files))

  make_directory.call(output_dir)
  write_python_app_yaml.call(app_id, output_dir)
  write_python_cicero_code.call(main_file, function_name, output_dir)
  copy_app_files.call(main_file, output_dir)
end</pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="write_go_app_yaml_file-method" class="method-detail ">
        <a name="method-c-write_go_app_yaml_file"></a>

        
        <div class="method-heading">
          <span class="method-name">write_go_app_yaml_file</span><span
            class="method-args">(app_id, output_dir, file=File)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Writes an app.yaml file for use with Go Google App Engine applications.
Right now, we direct all URL requests to the Go app we are about to
construct, but in the future we may add support for jQuery and Bootstrap to
automatically put a nice UI on the / url.</p>
          

          
          <div class="method-source-code"
            id="write_go_app_yaml_file-source">
<pre>
<span class="ruby-comment"># File lib/generator.rb, line 126</span>
def self.write_go_app_yaml_file(app_id, output_dir, file=<span class="ruby-constant">File</span>)
  app_yaml_contents = <span class="ruby-string">application: #{app_id.downcase}version: 1runtime: goapi_version: 3handlers:- url: /.*  script: _go_app</span>

  app_yaml_location = file.expand_path(output_dir + <span class="ruby-constant">File</span>::<span class="ruby-constant">Separator</span> +
    <span class="ruby-string">&quot;app.yaml&quot;</span>)

  file.open(app_yaml_location, <span class="ruby-string">&quot;w+&quot;</span>) { |file| file.write(app_yaml_contents) }
end</pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="write_go_cicero_code-method" class="method-detail ">
        <a name="method-c-write_go_cicero_code"></a>

        
        <div class="method-heading">
          <span class="method-name">write_go_cicero_code</span><span
            class="method-args">(file_name, function_name, output_dir, file=File)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Writes a main.go function that is a Go Google App Engine application with
the user’s function in it.</p>
          

          
          <div class="method-source-code"
            id="write_go_cicero_code-source">
<pre>
<span class="ruby-comment"># File lib/generator.rb, line 146</span>
def self.write_go_cicero_code(file_name, function_name, output_dir, file=<span class="ruby-constant">File</span>)
  package_name = <span class="ruby-constant">File</span>.basename(file_name, <span class="ruby-string">&quot;.go&quot;</span>)
  template_location = <span class="ruby-constant">File</span>.join(<span class="ruby-constant">File</span>.dirname(__FILE__), <span class="ruby-string">&quot;..&quot;</span>,
    <span class="ruby-string">&quot;templates&quot;</span>, <span class="ruby-string">&quot;main.go&quot;</span>)
  main_go_contents = file.open(template_location) { |f| f.read }
  main_go_contents.gsub!(<span class="ruby-regexp">/CICERO_FUNCTION_NAME/</span>, function_name)
  main_go_contents.gsub!(<span class="ruby-regexp">/CICERO_PKG_NAME/</span>, package_name)

  invokable_name = package_name + <span class="ruby-string">&quot;.&quot;</span> + function_name
  main_go_contents.gsub!(<span class="ruby-regexp">/CICERO_PACKAGE_AND_FUNCTION_NAME/</span>, invokable_name)
  main_go_location = file.expand_path(output_dir + <span class="ruby-constant">File</span>::<span class="ruby-constant">Separator</span> +
    <span class="ruby-string">&quot;main.go&quot;</span>)

  file.open(main_go_location, <span class="ruby-string">&quot;w+&quot;</span>) { |file| file.write(main_go_contents) }
end</pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="write_python_app_yaml_file-method" class="method-detail ">
        <a name="method-c-write_python_app_yaml_file"></a>

        
        <div class="method-heading">
          <span class="method-name">write_python_app_yaml_file</span><span
            class="method-args">(app_id, output_dir, file=File)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Writes an app.yaml file for use with Python Google App Engine applications.
TODO(cgb): Add support for jquery and bootstrap? If so, also be sure to
write those files in the given directory.</p>
          

          
          <div class="method-source-code"
            id="write_python_app_yaml_file-source">
<pre>
<span class="ruby-comment"># File lib/generator.rb, line 81</span>
def self.write_python_app_yaml_file(app_id, output_dir, file=<span class="ruby-constant">File</span>)
  app_yaml_contents = <span class="ruby-string">application: #{app_id}version: 1runtime: pythonapi_version: 1handlers:- url: .*  script: main.py</span>

  app_yaml_location = file.expand_path(output_dir + <span class="ruby-constant">File</span>::<span class="ruby-constant">Separator</span> +
    <span class="ruby-string">&quot;app.yaml&quot;</span>)

  file.open(app_yaml_location, <span class="ruby-string">&quot;w+&quot;</span>) { |file| file.write(app_yaml_contents) }
end</pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="write_python_cicero_code-method" class="method-detail ">
        <a name="method-c-write_python_cicero_code"></a>

        
        <div class="method-heading">
          <span class="method-name">write_python_cicero_code</span><span
            class="method-args">(file_name, function_name, output_dir, file=File)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Writes a main.py file for use with Python Google App Engine applications.
Sets up a standard set of routes according to the Cicero API. TODO(cgb):
The user may have their own imports in the code - consider automatically
placing them in as well.</p>
          

          
          <div class="method-source-code"
            id="write_python_cicero_code-source">
<pre>
<span class="ruby-comment"># File lib/generator.rb, line 103</span>
def self.write_python_cicero_code(file_name, function_name, output_dir,
  file=<span class="ruby-constant">File</span>)

  package_name = <span class="ruby-constant">File</span>.basename(file_name, <span class="ruby-string">&quot;.py&quot;</span>)
  template_location = <span class="ruby-constant">File</span>.join(<span class="ruby-constant">File</span>.dirname(__FILE__), <span class="ruby-string">&quot;..&quot;</span>,
    <span class="ruby-string">&quot;templates&quot;</span>, <span class="ruby-string">&quot;main.py&quot;</span>)
  main_py_contents = file.open(template_location) { |f| f.read }
  main_py_contents.gsub!(<span class="ruby-regexp">/CICERO_PACKAGE_NAME/</span>, package_name)
  main_py_contents.gsub!(<span class="ruby-regexp">/CICERO_FUNCTION_NAME/</span>, function_name)

  invokable_name = package_name + <span class="ruby-string">&quot;.&quot;</span> + function_name
  main_py_contents.gsub!(<span class="ruby-regexp">/CICERO_PACKAGE_AND_FUNCTION_NAME/</span>, invokable_name)

  main_py_location = file.expand_path(output_dir + <span class="ruby-constant">File</span>::<span class="ruby-constant">Separator</span> +
    <span class="ruby-string">&quot;main.py&quot;</span>)

  file.open(main_py_location, <span class="ruby-string">&quot;w+&quot;</span>) { |file| file.write(main_py_contents) }
end</pre>
          </div>
          
        </div>

        

        
      </div>

    
    </div>
  

  </div>

  <div id="validator-badges">
    <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
    <p><small>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish
      Rdoc Generator</a> 2</small>.</p>
  </div>

</body>
</html>

